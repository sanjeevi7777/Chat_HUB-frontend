{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WebTransport = void 0;\nconst transport_1 = require(\"../transport\");\nconst debug_1 = require(\"debug\");\nconst engine_io_parser_1 = require(\"engine.io-parser\");\nconst debug = (0, debug_1.default)(\"engine:webtransport\");\n/**\n * Reference: https://developer.mozilla.org/en-US/docs/Web/API/WebTransport_API\n */\nclass WebTransport extends transport_1.Transport {\n  constructor(session, stream, reader) {\n    super({\n      _query: {\n        EIO: \"4\"\n      }\n    });\n    this.session = session;\n    const transformStream = (0, engine_io_parser_1.createPacketEncoderStream)();\n    transformStream.readable.pipeTo(stream.writable).catch(() => {\n      debug(\"the stream was closed\");\n    });\n    this.writer = transformStream.writable.getWriter();\n    (async () => {\n      try {\n        while (true) {\n          const {\n            value,\n            done\n          } = await reader.read();\n          if (done) {\n            debug(\"session is closed\");\n            break;\n          }\n          debug(\"received chunk: %o\", value);\n          this.onPacket(value);\n        }\n      } catch (e) {\n        debug(\"error while reading: %s\", e.message);\n      }\n    })();\n    session.closed.then(() => this.onClose());\n    this.writable = true;\n  }\n  get name() {\n    return \"webtransport\";\n  }\n  get supportsFraming() {\n    return true;\n  }\n  async send(packets) {\n    this.writable = false;\n    try {\n      for (let i = 0; i < packets.length; i++) {\n        const packet = packets[i];\n        await this.writer.write(packet);\n      }\n    } catch (e) {\n      debug(\"error while writing: %s\", e.message);\n    }\n    this.writable = true;\n    this.emit(\"drain\");\n  }\n  doClose(fn) {\n    debug(\"closing WebTransport session\");\n    this.session.close();\n    fn && fn();\n  }\n}\nexports.WebTransport = WebTransport;","map":{"version":3,"names":["Object","defineProperty","exports","value","WebTransport","transport_1","require","debug_1","engine_io_parser_1","debug","default","Transport","constructor","session","stream","reader","_query","EIO","transformStream","createPacketEncoderStream","readable","pipeTo","writable","catch","writer","getWriter","done","read","onPacket","e","message","closed","then","onClose","name","supportsFraming","send","packets","i","length","packet","write","emit","doClose","fn","close"],"sources":["C:/Users/sanjeevi/Desktop/chatapp/chatapp_frontend/node_modules/engine.io/build/transports/webtransport.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebTransport = void 0;\nconst transport_1 = require(\"../transport\");\nconst debug_1 = require(\"debug\");\nconst engine_io_parser_1 = require(\"engine.io-parser\");\nconst debug = (0, debug_1.default)(\"engine:webtransport\");\n/**\n * Reference: https://developer.mozilla.org/en-US/docs/Web/API/WebTransport_API\n */\nclass WebTransport extends transport_1.Transport {\n    constructor(session, stream, reader) {\n        super({ _query: { EIO: \"4\" } });\n        this.session = session;\n        const transformStream = (0, engine_io_parser_1.createPacketEncoderStream)();\n        transformStream.readable.pipeTo(stream.writable).catch(() => {\n            debug(\"the stream was closed\");\n        });\n        this.writer = transformStream.writable.getWriter();\n        (async () => {\n            try {\n                while (true) {\n                    const { value, done } = await reader.read();\n                    if (done) {\n                        debug(\"session is closed\");\n                        break;\n                    }\n                    debug(\"received chunk: %o\", value);\n                    this.onPacket(value);\n                }\n            }\n            catch (e) {\n                debug(\"error while reading: %s\", e.message);\n            }\n        })();\n        session.closed.then(() => this.onClose());\n        this.writable = true;\n    }\n    get name() {\n        return \"webtransport\";\n    }\n    get supportsFraming() {\n        return true;\n    }\n    async send(packets) {\n        this.writable = false;\n        try {\n            for (let i = 0; i < packets.length; i++) {\n                const packet = packets[i];\n                await this.writer.write(packet);\n            }\n        }\n        catch (e) {\n            debug(\"error while writing: %s\", e.message);\n        }\n        this.writable = true;\n        this.emit(\"drain\");\n    }\n    doClose(fn) {\n        debug(\"closing WebTransport session\");\n        this.session.close();\n        fn && fn();\n    }\n}\nexports.WebTransport = WebTransport;\n"],"mappings":"AAAA,YAAY;;AACZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,YAAY,GAAG,KAAK,CAAC;AAC7B,MAAMC,WAAW,GAAGC,OAAO,CAAC,cAAc,CAAC;AAC3C,MAAMC,OAAO,GAAGD,OAAO,CAAC,OAAO,CAAC;AAChC,MAAME,kBAAkB,GAAGF,OAAO,CAAC,kBAAkB,CAAC;AACtD,MAAMG,KAAK,GAAG,CAAC,CAAC,EAAEF,OAAO,CAACG,OAAO,EAAE,qBAAqB,CAAC;AACzD;AACA;AACA;AACA,MAAMN,YAAY,SAASC,WAAW,CAACM,SAAS,CAAC;EAC7CC,WAAWA,CAACC,OAAO,EAAEC,MAAM,EAAEC,MAAM,EAAE;IACjC,KAAK,CAAC;MAAEC,MAAM,EAAE;QAAEC,GAAG,EAAE;MAAI;IAAE,CAAC,CAAC;IAC/B,IAAI,CAACJ,OAAO,GAAGA,OAAO;IACtB,MAAMK,eAAe,GAAG,CAAC,CAAC,EAAEV,kBAAkB,CAACW,yBAAyB,EAAE,CAAC;IAC3ED,eAAe,CAACE,QAAQ,CAACC,MAAM,CAACP,MAAM,CAACQ,QAAQ,CAAC,CAACC,KAAK,CAAC,MAAM;MACzDd,KAAK,CAAC,uBAAuB,CAAC;IAClC,CAAC,CAAC;IACF,IAAI,CAACe,MAAM,GAAGN,eAAe,CAACI,QAAQ,CAACG,SAAS,CAAC,CAAC;IAClD,CAAC,YAAY;MACT,IAAI;QACA,OAAO,IAAI,EAAE;UACT,MAAM;YAAEtB,KAAK;YAAEuB;UAAK,CAAC,GAAG,MAAMX,MAAM,CAACY,IAAI,CAAC,CAAC;UAC3C,IAAID,IAAI,EAAE;YACNjB,KAAK,CAAC,mBAAmB,CAAC;YAC1B;UACJ;UACAA,KAAK,CAAC,oBAAoB,EAAEN,KAAK,CAAC;UAClC,IAAI,CAACyB,QAAQ,CAACzB,KAAK,CAAC;QACxB;MACJ,CAAC,CACD,OAAO0B,CAAC,EAAE;QACNpB,KAAK,CAAC,yBAAyB,EAAEoB,CAAC,CAACC,OAAO,CAAC;MAC/C;IACJ,CAAC,EAAE,CAAC;IACJjB,OAAO,CAACkB,MAAM,CAACC,IAAI,CAAC,MAAM,IAAI,CAACC,OAAO,CAAC,CAAC,CAAC;IACzC,IAAI,CAACX,QAAQ,GAAG,IAAI;EACxB;EACA,IAAIY,IAAIA,CAAA,EAAG;IACP,OAAO,cAAc;EACzB;EACA,IAAIC,eAAeA,CAAA,EAAG;IAClB,OAAO,IAAI;EACf;EACA,MAAMC,IAAIA,CAACC,OAAO,EAAE;IAChB,IAAI,CAACf,QAAQ,GAAG,KAAK;IACrB,IAAI;MACA,KAAK,IAAIgB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,OAAO,CAACE,MAAM,EAAED,CAAC,EAAE,EAAE;QACrC,MAAME,MAAM,GAAGH,OAAO,CAACC,CAAC,CAAC;QACzB,MAAM,IAAI,CAACd,MAAM,CAACiB,KAAK,CAACD,MAAM,CAAC;MACnC;IACJ,CAAC,CACD,OAAOX,CAAC,EAAE;MACNpB,KAAK,CAAC,yBAAyB,EAAEoB,CAAC,CAACC,OAAO,CAAC;IAC/C;IACA,IAAI,CAACR,QAAQ,GAAG,IAAI;IACpB,IAAI,CAACoB,IAAI,CAAC,OAAO,CAAC;EACtB;EACAC,OAAOA,CAACC,EAAE,EAAE;IACRnC,KAAK,CAAC,8BAA8B,CAAC;IACrC,IAAI,CAACI,OAAO,CAACgC,KAAK,CAAC,CAAC;IACpBD,EAAE,IAAIA,EAAE,CAAC,CAAC;EACd;AACJ;AACA1C,OAAO,CAACE,YAAY,GAAGA,YAAY"},"metadata":{},"sourceType":"script","externalDependencies":[]}